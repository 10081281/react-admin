(this["webpackJsonpreact-adminv4"]=this["webpackJsonpreact-adminv4"]||[]).push([[13],{222:function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return S}));n(21);var a,i,r=n(25),o=(n(115),n(78)),l=n(1),c=n(2),u=n(3),s=n(4),d=n(0),f=n.n(d),p=n(77),m=n(17),g=n(11),h=(n(66),n(33)),b=n(82),v=Object(m.a)({ajax:!0,modal:{title:function(e){return e.isEdit?"\u4fee\u6539":"\u6dfb\u52a0"}}})(a=function(e){Object(s.a)(n,e);var t=Object(u.a)(n);function n(){var e;Object(l.a)(this,n);for(var a=arguments.length,i=new Array(a),r=0;r<a;r++)i[r]=arguments[r];return(e=t.call.apply(t,[this].concat(i))).state={loading:!1,data:{}},e.fetchData=function(){if(!e.state.loading){var t=e.props.id;e.setState({loading:!0}),e.props.ajax.get("/products/".concat(t)).then((function(t){e.setState({data:t}),Object.entries(t).forEach((function(e){var n=Object(b.a)(e,2),a=n[0];null===n[1]&&(t[a]=void 0)})),e.form.setFieldsValue(t)})).finally((function(){return e.setState({loading:!1})}))}},e.handleSubmit=function(t){if(!e.state.loading){var n=e.props.isEdit,a=n?"\u4fee\u6539\u6210\u529f\uff01":"\u6dfb\u52a0\u6210\u529f\uff01",i=n?e.props.ajax.put:e.props.ajax.post;e.setState({loading:!0}),i("/products",t,{successTip:a}).then((function(){var t=e.props.onOk;t&&t()})).finally((function(){return e.setState({loading:!1})}))}},e}return Object(c.a)(n,[{key:"componentDidMount",value:function(){this.props.isEdit&&this.fetchData()}},{key:"render",value:function(){var e=this,t=this.props.isEdit,n=this.state,a=n.loading,i=n.data,r={labelWidth:100};return f.a.createElement(g.g,{loading:a,okText:"\u4fdd\u5b58",cancelText:"\u91cd\u7f6e",onOk:function(){return e.form.submit()},onCancel:function(){return e.form.resetFields()}},f.a.createElement(h.default,{name:"product-modal-edit",initialValues:i,ref:function(t){return e.form=t},onFinish:this.handleSubmit},t?f.a.createElement(g.c,Object.assign({},r,{type:"hidden",name:"id"})):null,f.a.createElement(g.c,Object.assign({},r,{label:"\u63cf\u8ff0",name:"description",maxLength:200})),f.a.createElement(g.c,Object.assign({},r,{label:"\u4ea7\u54c1\u540d\u79f0",name:"name",required:!0,maxLength:50}))))}}]),n}(d.Component))||a,S=Object(m.a)({path:"/products",ajax:!0})(i=function(e){Object(s.a)(n,e);var t=Object(u.a)(n);function n(){var e;Object(l.a)(this,n);for(var a=arguments.length,i=new Array(a),r=0;r<a;r++)i[r]=arguments[r];return(e=t.call.apply(t,[this].concat(i))).state={loading:!1,dataSource:[],selectedRowKeys:[],total:0,pageNum:1,pageSize:20,deleting:!1,visible:!1,id:null},e.columns=[{title:"\u63cf\u8ff0",dataIndex:"description",width:200},{title:"\u4ea7\u54c1\u540d\u79f0",dataIndex:"name",width:200},{title:"\u64cd\u4f5c",dataIndex:"operator",width:100,render:function(t,n){var a=n.id,i=n.name,r=[{label:"\u4fee\u6539",onClick:function(){return e.setState({visible:!0,id:a})}},{label:"\u5220\u9664",color:"red",confirm:{title:'\u60a8\u786e\u5b9a\u5220\u9664"'.concat(i,'"?'),onConfirm:function(){return e.handleDelete(a)}}}];return f.a.createElement(g.h,{items:r})}}],e.handleSubmit=function(t){if(!e.state.loading){var n=e.state,a={pageNum:n.pageNum,pageSize:n.pageSize};e.setState({loading:!0}),e.props.ajax.get("/products",a).then((function(t){var n=(null===t||void 0===t?void 0:t.list)||[],a=(null===t||void 0===t?void 0:t.total)||0;e.setState({dataSource:n,total:a})})).finally((function(){return e.setState({loading:!1})}))}},e.handleDelete=function(t){e.state.deleting||(e.setState({deleting:!0}),e.props.ajax.del("/products/".concat(t),null,{successTip:"\u5220\u9664\u6210\u529f\uff01",errorTip:"\u5220\u9664\u5931\u8d25\uff01"}).then((function(){return e.form.submit()})).finally((function(){return e.setState({deleting:!1})})))},e.handleBatchDelete=function(){if(!e.state.deleting){var t=e.state.selectedRowKeys,n=f.a.createElement("span",null,"\u60a8\u786e\u5b9a\u5220\u9664",f.a.createElement("span",{style:{padding:"0 5px",color:"red",fontSize:18}},t.length),"\u6761\u8bb0\u5f55\u5417\uff1f");o.default.confirm({title:"\u6e29\u99a8\u63d0\u793a",content:n,onOk:function(){e.setState({deleting:!0}),e.props.ajax.del("/products",{ids:t},{successTip:"\u5220\u9664\u6210\u529f\uff01",errorTip:"\u5220\u9664\u5931\u8d25\uff01"}).then((function(){return e.form.submit()})).finally((function(){return e.setState({deleting:!1})}))}})}},e}return Object(c.a)(n,[{key:"componentDidMount",value:function(){this.handleSubmit()}},{key:"render",value:function(){var e=this,t=this.state,n=t.loading,a=t.deleting,i=t.dataSource,o=t.selectedRowKeys,l=t.total,c=t.pageNum,u=t.pageSize,s=t.visible,d=t.id,m=!(null===o||void 0===o?void 0:o.length);return f.a.createElement(p.a,{loading:n||a},f.a.createElement(g.l,null,f.a.createElement(r.default,{type:"primary",onClick:function(){return e.setState({visible:!0,id:null})}},"\u6dfb\u52a0"),f.a.createElement(r.default,{danger:!0,disabled:m,onClick:this.handleBatchDelete},"\u5220\u9664")),f.a.createElement(g.k,{serialNumber:!0,rowSelection:{selectedRowKeys:o,onChange:function(t){return e.setState({selectedRowKeys:t})}},columns:this.columns,dataSource:i,rowKey:"id",pageNum:c,pageSize:u}),f.a.createElement(g.i,{total:l,pageNum:c,pageSize:u,onPageNumChange:function(t){return e.setState({pageNum:t},(function(){return e.form.submit()}))},onPageSizeChange:function(t){return e.setState({pageSize:t,pageNum:1},(function(){return e.form.submit()}))}}),f.a.createElement(v,{visible:s,id:d,isEdit:null!==d,onOk:function(){return e.setState({visible:!1},(function(){return e.form.submit()}))},onCancel:function(){return e.setState({visible:!1})}}))}}]),n}(d.Component))||i}}]);
//# sourceMappingURL=13.d2618718.chunk.js.map