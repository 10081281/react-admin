{"version":3,"sources":["pages/users/Edit.jsx"],"names":["Edit","config","path","ajax","antd_es_form__WEBPACK_IMPORTED_MODULE_8__","create","state","loading","data","isEdit","fetchData","_this","id","props","setState","get","concat","then","res","finally","handleSubmit","form","validateFieldsAndScroll","err","values","ajaxMethod","put","post","successTip","onOk","this","match","params","_this$state","formProps","labelWidth","width","react__WEBPACK_IMPORTED_MODULE_9___default","a","createElement","_layouts_page_content__WEBPACK_IMPORTED_MODULE_12__","onSubmit","_library_components__WEBPACK_IMPORTED_MODULE_10__","Object","assign","type","field","initialValue","label","name","required","age","job","options","value","position","layout","antd_es_button__WEBPACK_IMPORTED_MODULE_1__","onClick","resetFields","Component"],"mappings":"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","file":"static/js/15.c9042ebf.chunk.js","sourcesContent":["import React, {Component} from 'react';\nimport {Form, Button} from 'antd';\nimport {FormElement, FormRow} from '@/library/components';\nimport config from '@/commons/config-hoc';\nimport PageContent from '@/layouts/page-content';\n\n@config({\n    path: '/users/_/edit/:id',\n    ajax: true,\n})\n@Form.create()\nexport default class Edit extends Component {\n    state = {\n        loading: false, // 页面加载loading\n        data: {},       // 表单回显数据\n        isEdit: false,  // 是否是编辑页面\n    };\n\n    componentDidMount() {\n        const {id} = this.props.match.params;\n        const isEdit = id !== ':id';\n\n        this.setState({isEdit});\n\n        if (isEdit) {\n            this.fetchData();\n        }\n    }\n\n    fetchData = () => {\n        if (this.state.loading) return;\n\n        const {id} = this.props;\n\n        this.setState({loading: true});\n        this.props.ajax.get(`/mock/users/${id}`)\n            .then(res => {\n                this.setState({data: res || {}});\n            })\n            .finally(() => this.setState({loading: false}));\n    };\n\n    handleSubmit = () => {\n        if (this.state.loading) return;\n\n        this.props.form.validateFieldsAndScroll((err, values) => {\n            if (err) return;\n\n            const {isEdit} = this.state;\n            const ajaxMethod = isEdit ? this.props.ajax.put : this.props.ajax.post;\n            const successTip = isEdit ? '修改成功！' : '添加成功！';\n\n            this.setState({loading: true});\n            ajaxMethod('/mock/users', values, {successTip})\n                .then(() => {\n                    const {onOk} = this.props;\n                    onOk && onOk();\n                })\n                .finally(() => this.setState({loading: false}));\n        });\n    };\n\n    render() {\n        const {form} = this.props;\n        const {loading, data, isEdit} = this.state;\n        const formProps = {\n            labelWidth: 100,\n            form,\n            width: '50%',\n        };\n\n        return (\n            <PageContent\n                loading={loading}\n            >\n                <Form onSubmit={this.handleSubmit}>\n                    {isEdit ? <FormElement {...formProps} type=\"hidden\" field=\"id\" initialValue={data.id}/> : null}\n                    <FormRow>\n                        <FormElement\n                            {...formProps}\n                            label=\"用户名\"\n                            field=\"name\"\n                            initialValue={data.name}\n                            required\n                        />\n                        <FormElement\n                            {...formProps}\n                            type=\"number\"\n                            label=\"年龄\"\n                            field=\"age\"\n                            initialValue={data.age}\n                            required\n                        />\n                        <FormElement\n                            {...formProps}\n                            type=\"select\"\n                            label=\"工作\"\n                            field=\"job\"\n                            initialValue={data.job}\n                            options={[\n                                {value: '1', label: '前端开发'},\n                                {value: '2', label: '后端开发'},\n                            ]}\n                        />\n                        <FormElement\n                            {...formProps}\n                            type=\"select\"\n                            label=\"职位\"\n                            field=\"position\"\n                            initialValue={data.position}\n                            options={[\n                                {value: '1', label: '员工'},\n                                {value: '2', label: 'CEO'},\n                            ]}\n                        />\n                    </FormRow>\n\n                    <FormRow>\n                        <FormElement {...formProps} layout>\n                            <Button type=\"primary\" onClick={this.handleSubmit}>保存</Button>\n                            <Button onClick={() => form.resetFields()}>重置</Button>\n                        </FormElement>\n                    </FormRow>\n                </Form>\n            </PageContent>\n        );\n    }\n}\n\n"],"sourceRoot":""}